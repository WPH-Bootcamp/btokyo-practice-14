<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo</title>
  </head>
  <body style="text-align: center; margin-top: 50px">
    <h1>Todo List</h1>
    <div>
      <input id="inputTodo" type="text" name="" id="" />
      <button id="btnAdd">Add</button>
    </div>
    <div style="width: 500px; margin: auto">
      <ul id="todoList">
        <li style="margin: 15px">
          <!-- firstChild -->
          <span> Isi todolist </span>
          <input
            style="width: 20px; height: 20px; margin: auto"
            type="checkbox"
            name=""
            id=""
            onchange="markAsDone(event)"
          />
          <!-- secondChild -->
          <button onclick="editTodoItem(event)">Edit</button>
          <!-- thirdChild -->
          <button onclick="deleteTodoItem(event)" class="deleteBtn">
            Delete
          </button>
        </li>
      </ul>
    </div>

    <!-- Popup  -->
    <div
      id="popup"
      style="
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        padding: 20px;
        border: 1px solid black;
      "
    >
      <h2>Edit Todo</h2>
      <input type="text" id="editInput" />
      <button id="saveEdit">Update</button>
      <button id="cancelEdit" style="margin-top: 10px">Cancel</button>
    </div>

    <script>
      const inputTodo = document.getElementById("inputTodo");
      const btnAdd = document.getElementById("btnAdd");
      const todoList = document.getElementById("todoList");
      const deleteButtons = document.getElementsByClassName("deleteBtn");

      // Mark as done function
      function markAsDone(event) {
        const checkbox = event.target;
        const li = checkbox.parentElement;
        if (checkbox.checked) {
          li.firstElementChild.style.textDecoration = "line-through";
        } else {
          li.firstElementChild.style.textDecoration = "none";
        }
      }

      // Function to delete a todo item
      function deleteTodoItem(event) {
        const li = event.target.parentElement;
        todoList.removeChild(li);
      }

      // Function to edit a todo item
      function editTodoItem(event) {
        const li = event.target.parentElement;
        const todoText = li.firstElementChild.textContent;
        const popup = document.getElementById("popup");
        const editInput = document.getElementById("editInput");
        const saveEdit = document.getElementById("saveEdit");
        const cancelEdit = document.getElementById("cancelEdit");

        editInput.value = todoText;
        popup.style.display = "block";

        saveEdit.onclick = () => {
          li.firstElementChild.textContent = editInput.value;
          popup.style.display = "none";
        };

        cancelEdit.onclick = () => {
          popup.style.display = "none";
        };
      }

      btnAdd.addEventListener("click", () => {
        const data = inputTodo.value;
        if (data.trim() === "") {
          alert("Please enter a todo item");
          return;
        }

        const li = document.createElement("li");
        li.style.margin = "15px";
        const span = document.createElement("span");
        span.textContent = data;
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.style.width = "20px";
        checkbox.style.height = "20px";
        checkbox.onchange = markAsDone;
        const editBtn = document.createElement("button");
        editBtn.textContent = "Edit";
        editBtn.onclick = editTodoItem;
        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "Delete";
        deleteBtn.onclick = deleteTodoItem;
        li.append(span, " ", checkbox, " ", editBtn, " ", deleteBtn);
        todoList.appendChild(li);

        inputTodo.value = "";
      });
    </script>
  </body>
</html>
